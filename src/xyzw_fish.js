
const BuHuoInfo = [
  {
    "level": 25,
    "prop": 4
  },
  {
    "level": 50,
    "prop": 4
  },
  {
    "level": 75,
    "prop": 4
  },
  {
    "level": 125,
    "prop": 8
  },
  {
    "level": 175,
    "prop": 8
  },
  {
    "level": 225,
    "prop": 8
  },
  {
    "level": 300,
    "prop": 12
  },
  {
    "level": 375,
    "prop": 12
  },
  {
    "level": 450,
    "prop": 12
  },
  {
    "level": 525,
    "prop": 12
  },
  {
    "level": 625,
    "prop": 16
  },
  {
    "level": 725,
    "prop": 16
  },
  {
    "level": 825,
    "prop": 16
  },
  {
    "level": 925,
    "prop": 16
  },
  {
    "level": 1050,
    "prop": 20
  },
  {
    "level": 1175,
    "prop": 20
  },
  {
    "level": 1300,
    "prop": 20
  },
  {
    "level": 1450,
    "prop": 24
  },
  {
    "level": 1600,
    "prop": 24
  },
  {
    "level": 1750,
    "prop": 24
  }
]
const YanGuanInfo = [
  {
    "level": 3,
    "prop": 1
  },
  {
    "level": 6,
    "prop": 1
  },
  {
    "level": 9,
    "prop": 1
  },
  {
    "level": 12,
    "prop": 1
  },
  {
    "level": 15,
    "prop": 1
  },
  {
    "level": 18,
    "prop": 1
  },
  {
    "level": 21,
    "prop": 1
  },
  {
    "level": 24,
    "prop": 1
  },
  {
    "level": 27,
    "prop": 1
  },
  {
    "level": 30,
    "prop": 1
  },
  {
    "level": 33,
    "prop": 1
  },
  {
    "level": 36,
    "prop": 1
  },
  {
    "level": 39,
    "prop": 1
  },
  {
    "level": 42,
    "prop": 1
  },
  {
    "level": 45,
    "prop": 1
  },
  {
    "level": 48,
    "prop": 1
  },
  {
    "level": 51,
    "prop": 1
  },
  {
    "level": 54,
    "prop": 1
  },
  {
    "level": 57,
    "prop": 1
  },
  {
    "level": 60,
    "prop": 1
  }
]
const JinZhuanInfo = [
  {
    "level": 10000,
    "prop": 3
  },
  {
    "level": 20000,
    "prop": 3
  },
  {
    "level": 30000,
    "prop": 3
  },
  {
    "level": 40000,
    "prop": 3
  },
  {
    "level": 50000,
    "prop": 3
  },
  {
    "level": 70000,
    "prop": 6
  },
  {
    "level": 90000,
    "prop": 6
  },
  {
    "level": 110000,
    "prop": 6
  },
  {
    "level": 130000,
    "prop": 6
  },
  {
    "level": 150000,
    "prop": 6
  },
  {
    "level": 180000,
    "prop": 9
  },
  {
    "level": 210000,
    "prop": 9
  },
  {
    "level": 240000,
    "prop": 9
  },
  {
    "level": 270000,
    "prop": 9
  },
  {
    "level": 300000,
    "prop": 9
  },
  {
    "level": 340000,
    "prop": 12
  },
  {
    "level": 380000,
    "prop": 12
  },
  {
    "level": 420000,
    "prop": 12
  },
  {
    "level": 460000,
    "prop": 12
  },
  {
    "level": 500000,
    "prop": 12
  }
]
const ZhaoMuInfo = [
  {
    "level": 80,
    "prop": 8
  },
  {
    "level": 160,
    "prop": 8
  },
  {
    "level": 240,
    "prop": 8
  },
  {
    "level": 320,
    "prop": 8
  },
  {
    "level": 400,
    "prop": 8
  },
  {
    "level": 560,
    "prop": 16
  },
  {
    "level": 720,
    "prop": 16
  },
  {
    "level": 880,
    "prop": 16
  },
  {
    "level": 1040,
    "prop": 16
  },
  {
    "level": 1200,
    "prop": 16
  },
  {
    "level": 1440,
    "prop": 24
  },
  {
    "level": 1680,
    "prop": 24
  },
  {
    "level": 1920,
    "prop": 24
  },
  {
    "level": 2160,
    "prop": 24
  },
  {
    "level": 2400,
    "prop": 24
  },
  {
    "level": 2720,
    "prop": 32
  },
  {
    "level": 3040,
    "prop": 32
  },
  {
    "level": 3360,
    "prop": 32
  },
  {
    "level": 3680,
    "prop": 32
  },
  {
    "level": 4000,
    "prop": 32
  }
]
const BaoXiangInfo = [
  {
    "level": 2000,
    "prop": 4
  },
  {
    "level": 4000,
    "prop": 4
  },
  {
    "level": 6000,
    "prop": 4
  },
  {
    "level": 8000,
    "prop": 4
  },
  {
    "level": 10000,
    "prop": 4
  },
  {
    "level": 14000,
    "prop": 8
  },
  {
    "level": 18000,
    "prop": 8
  },
  {
    "level": 22000,
    "prop": 8
  },
  {
    "level": 26000,
    "prop": 8
  },
  {
    "level": 30000,
    "prop": 8
  },
  {
    "level": 36000,
    "prop": 12
  },
  {
    "level": 42000,
    "prop": 12
  },
  {
    "level": 48000,
    "prop": 12
  },
  {
    "level": 54000,
    "prop": 12
  },
  {
    "level": 60000,
    "prop": 12
  },
  {
    "level": 68000,
    "prop": 16
  },
  {
    "level": 76000,
    "prop": 16
  },
  {
    "level": 84000,
    "prop": 16
  },
  {
    "level": 92000,
    "prop": 16
  },
  {
    "level": 100000,
    "prop": 16
  }
]
const NowInfo = {
  jinZhuan: 420837,
  buHuo: 1600,
  zhaoMu: 4000,
  yanGuan: 21,
  baoXiang: 100000,
  goldProp: 243,
  normalProp: 1
}
function getNormalInfo(used, info) {
  let propsGet = 0
  const infoLeft = []
  for (let i = 0; i < info.length; i++) {
    if (used >= info[i].level) {
      propsGet += info[i].prop
    } else {
      infoLeft.push(info[i])
    }
  }
  return {
    used,
    total: info[info.length - 1].level,
    propsGet,
    infoLeft,
    isOver: used === info[info.length - 1].level
  };
}

function checkBuHuoInfo(info) {
  if (info.isOver) return console.log('捕获已达到最高等级')
  pushStatusResult(`【捕获】还可以做 ${info.infoLeft.length} 档`, '')
  info.infoLeft.forEach(info => {
    pushStatusResult(info.level, info.prop)
  })
}

function checkYanGuanInfo(info) {
  if (info.isOver) return console.log('盐罐已达到最高等级')
  console.log(`【盐罐】还可以做${info.infoLeft.length}档，剩余档位信息：`)
  console.table(info.infoLeft)
}

function checkJinZhuanInfo(info) {
  if (info.isOver) return console.log('金砖已达到最高等级')
  pushStatusResult(`【金砖】还可以做 ${info.infoLeft.length} 档`, '')
  info.infoLeft.forEach(info => {
    pushStatusResult(info.level, info.prop)
  })
}

function checkZhaoMuInfo(info) {
  if (info.isOver) return console.log('招募已达到最高等级')
  console.log(`【招募】还可以做${info.infoLeft.length}档，剩余档位信息：`)
  console.table(info.infoLeft)
}

function checkBaoXiangInfo(info) {
  if (info.isOver) return console.log('宝箱已达到最高等级')
  console.log(`【宝箱】还可以做${info.infoLeft.length}档，剩余档位信息：`)
  console.table(info.infoLeft)
}

function pushInfoResult(label, value) {
  console.log(label, value)
  infoResult.push({
    label,
    value
  })
}
function pushStatusResult(label, value) {
  console.log(label, value)
  statusResult.push({
    label,
    value
  })
}

const infoResult = []
const statusResult = []
export function calc(nowInfo = NowInfo) {
  infoResult.length = 0
  const nowBuHuoInfo = getNormalInfo(nowInfo.buHuo, BuHuoInfo)
  const nowYanGuanInfo = getNormalInfo(nowInfo.yanGuan, YanGuanInfo)
  const nowJinZhuanInfo = getNormalInfo(nowInfo.jinZhuan, JinZhuanInfo)
  const nowZhaoMuInfo = getNormalInfo(nowInfo.zhaoMu, ZhaoMuInfo)
  const nowBaoXiangInfo = getNormalInfo(nowInfo.baoXiang, BaoXiangInfo)
  pushInfoResult('捕获消耗' + (nowBuHuoInfo.isOver ? '【满】' : ''), nowBuHuoInfo.used, `${nowBuHuoInfo.used} '/' ${nowBuHuoInfo.total}`)
  pushInfoResult('盐罐消耗' + (nowYanGuanInfo.isOver ? '【满】' : ''), nowYanGuanInfo.used, `${nowYanGuanInfo.used} '/' ${nowYanGuanInfo.total}`)
  pushInfoResult('金砖消耗' + (nowJinZhuanInfo.isOver ? '【满】' : ''), nowJinZhuanInfo.used, `${nowJinZhuanInfo.used} '/' ${nowJinZhuanInfo.total}`)
  pushInfoResult('招募消耗' + (nowZhaoMuInfo.isOver ? '【满】' : ''), nowZhaoMuInfo.used, `${nowZhaoMuInfo.used} '/' ${nowZhaoMuInfo.total}`)
  pushInfoResult('宝箱消耗' + (nowBaoXiangInfo.isOver ? '【满】' : ''), nowBaoXiangInfo.used, `${nowBaoXiangInfo.used} '/' ${nowBaoXiangInfo.total}`)
  pushInfoResult('------------------', '')

  const sum = nowBuHuoInfo.propsGet + nowYanGuanInfo.propsGet + nowJinZhuanInfo.propsGet + nowZhaoMuInfo.propsGet + nowBaoXiangInfo.propsGet
  pushInfoResult('当前金道具转换概率', (nowInfo.goldProp * 100 / sum).toFixed(2) + '%')
  pushInfoResult('已获得普通道具', sum)
  pushInfoResult('剩余可获得普通道具', (1050 - sum))
  pushInfoResult('已获得金道具', nowInfo.goldProp)

  pushStatusResult('距离拿金鱼还差金道具', (250 - nowInfo.goldProp))
  pushStatusResult('根据25%的转换率，还需要普通道具', (250 - nowInfo.goldProp) * 4)
  if (!nowYanGuanInfo.isOver) pushStatusResult('盐罐任务尚未完成，还可以获得', nowYanGuanInfo.infoLeft.length)
  if (nowInfo.normalProp) pushStatusResult('未兑换的普通道具', nowInfo.normalProp)
  pushStatusResult('故还差普通道具', (250 - nowInfo.goldProp) * 4 - nowYanGuanInfo.infoLeft.length - nowInfo.normalProp)
  checkBuHuoInfo(nowBuHuoInfo)
  checkJinZhuanInfo(nowJinZhuanInfo)
}
export function getInfoResult(){
  return infoResult
}
export function getStatusResult(){
  return statusResult
}